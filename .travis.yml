language: php

php:
  - 5.4

before_script:
  - mysql -e 'CREATE DATABASE lightning_test;'
  - php composer.phar install --prefer-source

script:
  - vendor/bin/phpunit -c app/ --coverage-text
  - vendor/bin/phpcs --standard=PSR2 -n src/

after_failure:
  - cat app/logs/test.log

notifications:
  webhooks:
    urls:
      - http://lightning.farnsworth.ch/deploy.php
    on_success: always
    on_failure: never
